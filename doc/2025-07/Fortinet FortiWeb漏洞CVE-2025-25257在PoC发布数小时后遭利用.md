#  Fortinet FortiWeb漏洞CVE-2025-25257在PoC发布数小时后遭利用  
鹏鹏同学  黑猫安全   2025-07-21 01:24  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/8dBEfDPEce8ZFaCb0IyoVa5RIZrr1FNCibv8YtrXM1cfEFgibzCYDFZFFLjoia8lMxBuc9eA4RZ8EwCUzmxVtdmqQ/640?wx_fmt=png&from=appmsg "")  
  
7月11日概念验证代码（PoC）公开后，黑客立即开始利用FortiWeb的SQL注入漏洞（CVE-2025-25257）。该漏洞（CWE-89）允许未认证攻击者通过特制HTTP/HTTPS请求执行任意SQL命令。  
  
Fortinet官方公告指出："FortiWeb中存在的SQL命令特殊元素过滤不严漏洞（CWE-89），可能使未认证攻击者通过精心构造的HTTP/HTTPS请求执行未授权SQL代码。"目前该漏洞已通过7.6.4、7.4.8、7.2.11和7.0.11版本安全更新修复，漏洞发现者GMO Cybersecurity研究员川根健太郎遵循了负责任披露原则。  
  
**漏洞分析深度追踪**  
  
安全团队watchTowr通过对比7.6.3与7.6.4版本的httpsd服务二进制文件，定位到修复补丁的具体变更。研究人员发现：  
1. 该SQL注入漏洞可被升级为远程代码执行（RCE）  
  
1. 利用MySQL的INTO OUTFILE  
语句时，因配置错误导致文件能以root权限写入  
  
1. 首次尝试在CGI目录部署webshell失败后，转而利用现有Python脚本（ml-draw.py）的.pth文件执行特性  
  
1. 通过数据库分块提取载荷，最终实现在CGI脚本触发时执行任意Python代码  
  
**攻击态势速览**  
  
• Shadowserver监测显示：受攻击系统从7月11日PoC发布后的85例降至7月18日的35例  
  
• watchTowr已发布漏洞检测工具生成器  
  
• 目前主要攻击载体为：未授权SQL注入→文件写入→Python环境劫持链式攻击  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/8dBEfDPEce8ZFaCb0IyoVa5RIZrr1FNCOKQa5QEXVFWF016FlODEucd8fH0iaV7H8ticwxqE5BVHcG6s3yTkUoCg/640?wx_fmt=png&from=appmsg "")  
  
**FortiWeb安全态势最新监测数据**  
1. **暴露接口风险**  
  
Shadowserver基金会2025年7月16日通报：截至7月15日仍检测到223个暴露在公网的FortiWeb管理接口（虽无法确认补丁状态，但若未修复CVE-2025-25257漏洞则极可能已全部沦陷）。  
  
▶️ 暴露设备分布热力图  
  
1. **已确认攻击事件**  
  
同一报告显示：通过CVE-2025-25257漏洞植入webshell的案例从7月14日的85例降至7月15日的77例。该漏洞自7月11日起即出现活跃攻击。  
  
▶️ 受感染设备分布热力图  
  
1. **全网设备普查**  
  
Censys最新扫描发现20,098台在线FortiWeb设备（已排除蜜罐），但多数未明确暴露。由于缺乏版本信息，无法判定漏洞影响范围。其公告指出：  
  
"大量主机返回500/503错误（可能启用了过滤机制），但这不能确保完全防护。管理员可通过以下查询筛选可交互设备："  
  
text  
```
```  
  
**紧急行动建议**  
  
鉴于漏洞利用代码已公开，所有管理员应立即：  
  
✓ 升级至7.6.4/7.4.8/7.2.11/7.0.11安全版本  
  
✓ 检查管理接口暴露情况  
  
✓ 监控可疑的webshell部署行为  
  
  
