#  CVE-2025-32462 Sudo chroot本地提权漏洞  
原创 薛小蛮  AI安全手记   2025-07-01 06:52  
  
Sudo实用程序是安装在 Linux 系统上的特权命令行工具，允许允许用户以超级用户或安全策略指定的其他用户的身份执行命令。它通常用于通过委派需要提升权限的管理任务而不共享 root 密码来实现最低权限模型，同时还在系统日志中创建审计跟踪。  
#### 漏洞描述  
  
由于允许非特权用户在其控制下的可写、不可信路径上调用 _chroot（）而_引起的。不管用户是否配置了相应的 Sudo 规则，Sudo 都会多次调用 chroot（）  
。  
  
允许低特权用户以 root 权限调用 chroot（）  
 到可写位置可能会带来各种安全风险。许多应用程序，如 SSH，明确地防止这一点。例如，如果目标位置不归 root 所有，则 SSH 将拒绝 chroot（）。  
pivot_root（）  
 和 unpivot_root（）  
 函数在 plugins/sudoers/plugin. c 中定义，用于处理 chroot  
 逻辑。在这两个调用之间，会触发名称服务交换（NSS） 操作，导致系统从不受信任的环境加载 /etc/nsswitch.conf  
 配置文件。此文件包含指示系统如何检索有关用户、组和主机的信息的指令。可以列出多个来源，并按顺序搜索直到匹配为止。  
#### 复现环境版本  
#### 使用x云默认安装的ubuntu环境  
  
![image.png|500](https://mmbiz.qpic.cn/mmbiz_png/LRFSic7veEzNCP1t2y88iaLbiah1OttH24sdVfofA95Piaic0icazEBHUM380a3icJsPNEFibvCzGY8nkEpd3jtWIrQbeQ/640?from=appmsg "")  
#### 漏洞复现  
  
![image.png|500](https://mmbiz.qpic.cn/mmbiz_png/LRFSic7veEzNCP1t2y88iaLbiah1OttH24sVGDG2vaxNlhWB1lnCYcKf2663uvQUBVe5CMCb14hzWTO7BhdCgbOgQ/640?from=appmsg "")  
#### 影响版本  
  
默认的 Sudo 配置易受攻击。虽然该漏洞涉及 Sudo chroot 功能，但它不需要为用户定义任何 Sudo 规则。因此，如果安装了易受攻击的版本，任何本地非特权用户都有可能将权限升级到 root。以下版本已知易受攻击。注：并非所有版本的范围内进行了测试。  
  
1.9.0 - 1.9.17  
  
1.8.8 - 1.8.32  
  
  
已核实的版本情况如下：  
  
Ubuntu 24.04.1; Sudo 1.9.15p5，Sudo 1.9.16p2  
  
macOS Sequoia 15.3.2; Sudo 1.9.13p2  
#### 修复建议  
#### 1.升级到最新版本。  
  
  
