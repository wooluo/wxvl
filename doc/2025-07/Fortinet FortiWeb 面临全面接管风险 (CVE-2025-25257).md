#  Fortinet FortiWeb 面临全面接管风险 (CVE-2025-25257)  
会杀毒的单反狗  军哥网络安全读报   2025-07-14 01:01  
  
**导****读**  
  
  
  
网络安全研究人员发现Fortinet 安全软件关键部分FortiWeb Fabric Connector的一个主要漏洞CVE-2025-25257 ，该漏洞对于将 Fortinet 的 Web 应用程序防火墙 (FortiWeb) 与其他安全工具连接起来实现动态保护至关重要。  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/AnRWZJZfVaGB6KIkwlOQfqfyumm8454Tl6JxicbIkPlSXFhg2ibBrWzoX4lEy60UctalJUzu97prbvszpgoziaRXQ/640?wx_fmt=jpeg&from=appmsg "")  
  
  
该漏洞最初由 Ierae 公司报告给 Fortinet。随后，研究人员演示并发布了如何将该漏洞升级至完全系统控制。  
  
  
这是一个“GUI 中未经身份验证的 SQL 注入”漏洞，这意味着攻击者无需用户名或密码即可利用系统管理界面中的弱点，通过在互联网上发送专门设计的请求来诱骗 FortiWeb 系统运行任意命令。  
  
  
WatchTowr 实验室通过比较 FortiWeb 7.6.4 版和旧版本 7.6.3 发现了这个隐藏的问题。  
  
  
他们指出，该/bin/httpsd程序的 get_fabric_user_by_token 函数存在漏洞。该函数用于从其他 Fortinet 设备（例如 FortiGate 防火墙）登录，但它未能正确检查传入信息，导致攻击者利用请求中的 Authorisation: Bearer 标头注入恶意命令/api/fabric/device/status。  
  
  
由于命令中不允许使用空格等限制，最初的尝试颇为棘手。然而，研究人员巧妙地利用 MySQL 的注释语法绕过了这一限制(/**/)。这使得 SQL 注入成功，甚至允许他们通过一个简单的'or'1'='1命令完全绕过登录检查，该命令返回“200 OK”消息以确认成功。  
  
  
研究人员成功将初始 SQL 注入升级为远程代码执行 (RCE)。他们使用 MySQL 的 INTO OUTFILE 语句将文件直接写入系统目录。一个关键发现是，数据库进程以 root 权限运行，这使得它几乎可以在任何地方放置有害文件。  
  
  
虽然无法直接执行，但他们利用了/cgi-bin文件夹中现有的 Python 脚本，该脚本会自动以高权限执行。通过将一个特殊的 Python 文件 (.pth) 写入特定的 Python 目录，他们可以强制系统运行他们编写的 Python 代码，从而实现完全的系统入侵。  
  
### 潜在后果及应对措施  
###   
  
攻击者可完全控制 FortiWeb 设备以及其他可能连接的系统。这可能导致敏感数据被盗、服务中断，或利用系统进行进一步攻击，最终造成重大的财务、声誉和法律损失。  
  
  
研究人员建议立即将FortiWeb 系统更新至补丁版本。如果无法立即更新，Fortinet 建议暂时禁用 HTTP/HTTPS 管理界面。  
  
  
受影响的 FortiWeb 版本：  
- 7.6.0 至 7.6.3（升级到 7.6.4 或更新版本）  
- 7.4.0 至 7.4.7（升级到 7.4.8 或更新版本）  
- 7.2.0 至 7.2.10（升级到 7.2.11 或更新版本）  
- 7.0.0 到 7.0.10（升级到 7.0.11 或更新版本）  
漏洞公告：  
  
https://fortiguard.fortinet.com/psirt/FG-IR-25-151  
  
  
新闻链接：  
  
https://hackread.com/critical-vulnerability-fortinet-fortiweb-cve-2025-25257/  
  
![](https://mmbiz.qpic.cn/mmbiz_jpg/AnRWZJZfVaGC3gsJClsh4Fia0icylyBEnBywibdbkrLLzmpibfdnf5wNYzEUq2GpzfedMKUjlLJQ4uwxAFWLzHhPFQ/640?wx_fmt=jpeg "")  
  
扫码关注  
  
军哥网络安全读报  
  
**讲述普通人能听懂的安全故事**  
  
  
