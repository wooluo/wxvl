#  Flodrix僵尸网络正攻击存在漏洞的Langflow服务器  
鹏鹏同学  黑猫安全   2025-06-19 01:15  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/8dBEfDPEce96Px8ssUa5fAWicZo7HcoN663581C9X8jsNcgLxgPWuGbf5hWw2cZfLOITicAiaFqjQ7FOzibLk0K4sw/640?wx_fmt=png&from=appmsg "")  
  
趋势研究（Trend Research）发现黑客正利用漏洞CVE-2025-3248传播Flodrix僵尸网络。攻击者通过该漏洞在Langflow服务器上执行恶意脚本，进而下载安装Flodrix恶意软件。  
  
趋势研究在报告中警告："若成功利用该漏洞，Flodrix僵尸网络的操控者将能完全控制系统，发起DDoS攻击，并可能导致受影响Langflow服务器上的敏感信息泄露。"  
  
今年5月，美国网络安全和基础设施安全局（CISA）已将该漏洞（CVSS评分9.8）列入已知被利用漏洞目录（KEV）。Langflow作为构建智能体AI工作流的流行工具，其/api/v1/validate/code端点存在代码注入漏洞。远程攻击者无需认证即可通过特制HTTP请求实现任意代码执行，影响1.3.0之前所有版本。  
  
网络安全公司Horizon3.ai的研究人员指出该漏洞极易被利用："现在实现远程代码执行易如反掌——只需将有效载荷嵌入装饰器即可。例如针对10.0.220.200这个存在漏洞的主机，攻击者就能获取Python反向shell。"该公司在技术博客中展示了具体攻击示例。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/8dBEfDPEce96Px8ssUa5fAWicZo7HcoN60YrnHUgn4WghLDtR9tKxichZkxoWlxrGBAbE12jVgItVr9TvltDuyAQ/640?wx_fmt=png&from=appmsg "")  
  
在该漏洞（CVE-2025-3248）公开后，有研究人员发布了利用Python函数默认参数特性的概念验证（PoC）攻击代码。这些参数在Python中同样以表达式形式存在，会在函数定义时执行。趋势科技发现攻击者正使用开源PoC代码攻击存在漏洞的系统，实现代码执行并投递恶意负载。  
  
攻击者利用公开的PoC代码安装Flodrix恶意软件，该僵尸网络可发起分布式拒绝服务（DDoS）攻击。研究人员观察到，攻击者先通过Shodan等工具扫描互联网上未打补丁的Langflow服务器，获取shell权限后执行bash命令进行侦察，收集系统用户、环境变量和网络配置等信息，随后从远程服务器下载并执行Flodrix恶意软件。该恶意软件会连接命令控制（C&C）服务器准备DDoS攻击，若运行参数无效则会自删除——这可能是用于测试目标兼容性的机制。漏洞根源在于Python代码验证机制存在缺陷，导致未认证的远程代码执行成为可能。  
  
趋势科技报告指出："该恶意软件支持两种C&C通信通道：标准TCP协议和Tor匿名网络。默认情况下会通过TCP通道建立连接。"  
  
攻击链分析显示，攻击者利用漏洞后会执行名为"docker"的bash脚本，该脚本会下载适配不同系统的Flodrix僵尸网络ELF二进制文件。脚本通过检查系统输出来验证执行结果，若出现特定信息则删除文件。为避免系统崩溃，脚本会跳过关键进程终止操作，并采用wget、curl、tftp等多种下载方式确保文件获取。多个变体的存在表明攻击活动正在持续演进。  
  
此次传播的负载是LeetHozer恶意软件的新变种，采用自删除、痕迹清除、字符串混淆等隐匿技术逃避检测。报告强调："值得注意的是，新版本支持通过TCP和UDP双通道与C&C基础设施通信。连接后可接收TCP指令发动多种DDoS攻击。"  
  
趋势专家发现，虽然Flodrix样本在XOR密钥和流量结构等方面与已知变种相似，但存在显著改进：包括修改响应头、新增加密DDoS攻击类型、增加配置选项等。最关键的是新增了通过/proc目录枚举进程的功能——若发现systemd、busybox等可疑进程或/tmp目录运行的进程，会立即终止它们并通过UDP端口50445向C&C服务器发送详细击杀报告。  
  
报告总结道："新变种会遍历/proc目录获取所有运行进程的PID，收集进程名、执行路径及命令行参数等信息。当检测到init、systemd、watchdog等特定进程或/tmp目录运行的进程时，会发送以'KILLDETAIL|'开头的通知消息至C&C服务器。"报告同时提供了完整的入侵指标（IOCs）。  
  
Flodrix植入后即与远程服务器建立连接，通过TCP接收指令对目标IP发动DDoS攻击，同时支持通过Tor网络隐蔽通信。研究人员指出："由于Langflow缺乏输入验证和沙箱机制，攻击载荷能在服务器上下文中编译执行，最终导致远程代码执行。攻击者很可能正在对所有易受攻击服务器进行画像，收集数据以识别高价值目标。"  
  
趋势科技确认，未知威胁行为者在托管Flodrix的同一主机上部署了多种下载脚本，表明攻击活动仍在积极开发中。Flodrix被评估为Moobot组织关联的LeetHozer僵尸网络进化版，其改进包括自删除功能、减少取证痕迹、混淆C2服务器地址等反分析手段。趋势科技补充道："另一重大变化是新增了加密的DDoS攻击类型，进一步增强了混淆性。新变种还通过/proc目录枚举运行进程实现深度检测。"  
  
  
