#  Langflow远程代码执行漏洞（CVE-2025-3248）POC及一键部署环境  
原创 a1batr0ss  天翁安全   2025-06-25 01:00  
  
**免责声明：**  
本公众号所发布的全部内容，包括但不限于技术文章、POC脚本、漏洞利用工具及相关测试环境，均仅限于合法的网络安全学习、研究和教学用途。所有人在使用上述内容时，应严格遵守中华人民共和国相关法律法规以及道德伦理要求。未经明确的官方书面授权，严禁将公众号内的任何内容用于未经授权的渗透测试、漏洞利用或攻击行为。 所有人仅可在自己合法拥有或管理的系统环境中进行本地漏洞复现与安全测试，或用于具有明确授权的合法渗透测试项目。所有人不得以任何形式利用公众号内提供的内容从事非法、侵权或其他不当活动。 如因违反上述规定或不当使用本公众号提供的任何内容，造成的一切法律责任、经济损失、纠纷及其他任何形式的不利后果，均由相关成员自行承担，与本公众号无任何关联。  
## 漏洞介绍  
  
Langflow 是一个可视化的低代码平台，用于构建和调试基于 **LangChain**  
 的大语言模型应用。它通过拖拽式界面帮助用户快速搭建包括聊天机器人、问答系统、文档问询等复杂的 AI 流程，而无需编写大量代码。Langflow 支持组件化设计，集成了 Prompt、LLM、Memory、工具链等模块，适合开发者、研究人员以及对 AI 应用感兴趣的非技术用户使用，加快原型开发和测试的效率。  
  
1.3.0 版本之前的 Langflow 存在代码注入漏洞，影响 /api/v1/validate/code  
 接口。远程未认证的攻击者可通过构造恶意的 HTTP 请求，执行任意代码。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtDGu0EfBGpaamfq79DfAe6k1CBTfIvZ7U7onoV1DsZc9jZCAOiaUQmyQ/640?wx_fmt=png&from=appmsg "")  
## 漏洞版本  
- Langflow < 1.3.0  
  
## 漏洞环境一键部署  
  
执行以下一条命令，一键部署langflow漏洞环境  
```
docker run -p 7860:7860 langflowai/langflow:1.2.0
```  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtuwXdEibkT9DQxu4ibiaMqA5sOp7x5IuWH0Y8xqZibibMSjsPToX5TyXaDTA/640?wx_fmt=png&from=appmsg "")  
  
访问 http://127.0.0.1:7860/ 看到如下页面代表部署成功  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtLxz2GsnH633hnaudoyl26cT1K3B0Z9Cibld6DibEKOWsbO3E4TOuOFpw/640?wx_fmt=png&from=appmsg "")  
## 漏洞利用  
  
使用如图POC执行任意命令  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAttejBrdgreYpiaiaKBfw9b8COUu5jENktGpdfVsZBGCEAVY20icwTvKwsw/640?wx_fmt=png&from=appmsg "")  
## 漏洞成因  
  
漏洞由于/api/v1/validate/code端点没有做身份验证，允许匿名访问并执行validate_code函数  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAt9po1taK5uzZGVmpoUrMBIOLshhlAicJsjkD3BhkKLZ19VFrZBic16P4A/640?wx_fmt=png&from=appmsg "")  
  
且validate_code函数没有做任何过滤就执行了exec()  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtbAmpRTsDTYWeyxslSpSujdLLqwaDOnCF08yNaaickiaZ3Jb50M5dYxMg/640?wx_fmt=png&from=appmsg "")  
## 漏洞修复  
  
Langflow官方对这个漏洞做了几处修复：  
  
1.给/api/v1/validate/code端点添加了JWT认证  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtf4ortP9bjicT1kcvZV1BnDr0bicelsbRhUtgfeKgB49diaf5JDrTaoD4Q/640?wx_fmt=png&from=appmsg "")  
  
2.增加了严格的输入验证和身份校验  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtpyicMRKuDiatynsk54u1eibRG8glykSxtu2dCrJ8uU9XMJULU0trSE3Cg/640?wx_fmt=png&from=appmsg "")  
  
**修复需要将版本升级**  
- Roundcube Webmail >= 1.3.0  
  
## 知识星球  
  
**漏洞利用POC和批量检查脚本**  
可在知识星球内自行领取  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAt6hR3dcXria0aeCL5Z4YrpmI8TB2ro9VJTZqxJq264GASksicg1td2QaQ/640?wx_fmt=png&from=appmsg "")  
> 星球不定期更新市面上最新的热点漏洞及复现环境，欢迎加入交流和学习  
  
  
亮点一、**市面热点漏洞详细分析**  
，与**deepseek本地部署**  
息息相关的：Ollama任意文件读取漏洞（CVE-2024-37032）详细分析  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtCqTVfjZ2ZyUNkEqO4o2jUibhc8Fj8vM9Jk5x8ickdEMUPbL9HeVzFiaog/640?wx_fmt=png&from=appmsg "")  
  
亮点二、**近日最新披露**  
漏洞：Erlang/OTP SSH 远程代码执行漏洞（CVE-2025-32433）POC及一键部署环境  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtOmPgJAYg5d5HC44ZUp5yNibvQaDkKPmiaRbdGCySiagXsyvSAOWvHDumg/640?wx_fmt=png&from=appmsg "")  
  
以及有师傅对该POC提出疑问后也会进行解答：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtG8QkThHabXsNliaKD270BCmMic3stqI5dODbYCBqK03reCAXWBt2buibw/640?wx_fmt=png&from=appmsg "")  
  
亮点三、**框架漏洞专题-若依：**  
  
若依某漏洞分析：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtNz16KpmfB2ycyiaDTZz0Mtia373Z3KdectED4ssQ1eZvpxnjdfQEnNEg/640?wx_fmt=png&from=appmsg "")  
  
以及帮助师傅们轻松搭建若依环境的docker的tar包：  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtxiafep2iaWBcFlx2WVI0COsA27ibWZMZF58hUa4dPAem2fq3bVibmom3KQ/640?wx_fmt=png&from=appmsg "")  
  
亮点四、**实战渗透测试技巧分享&讨论**  
：记一次信息泄漏到数据库接管的渗透测试  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtrH7Noibf7nibRhxiajafHo6W5sOV7qBS7T0UZicoiaDo7bTcG9lrwMYsBSw/640?wx_fmt=png&from=appmsg "")  
  
某次若依系统渗透测试带来的思考与讨论  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtVaZavLYZ4ww5N1lCdxiclBeI2MRnia8iaiawOlhWlPr98ZkWWP3tic9VRlw/640?wx_fmt=png&from=appmsg "")  
  
亮点五、一些比较新奇有趣的漏洞分享：Windows**拖拽图标**  
而触发的漏洞  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtACpQaRu93ASUfoosM9nk7tian7nmzrChtQrO8BvF1gVxXh5kkiaYUhKw/640?wx_fmt=png&from=appmsg "")  
  
知识星球加入方式如下，欢迎师傅们加入进行学习和讨论！  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/I2eHcAFia5S73DRADfPAd7coIhQFkbIAtreAWAJtpkncfObHT8gJUR9UrayoCesdKkXbB4ibIetCW2Cw45oQ6HKQ/640?wx_fmt=png&from=appmsg "")  
  
  
