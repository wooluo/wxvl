#  第六章URL跳转漏洞-原理到实战  
原创 今木安全  今木安全   2025-06-18 16:03  
  
# 1. 定义  
  
URL跳转漏洞（开放重定向漏洞）发生在Web应用程序未经验证地将用户重定向到第三方URL时。该漏洞允许攻击者构造恶意链接，将用户从可信网站重定向到钓鱼网站或恶意内容页面。  
  
**核心问题**  
：应用程序将用户控制的输入直接用于重定向操作，未进行安全验证：  
## 2. 现象  
### 典型漏洞表现：  
```
```  
### 漏洞特征：  
- URL中包含redirect  
、return  
、url  
等参数  
- 302状态码或HTML meta刷新跳转  
- 跳转后地址与当前域名不相关  
- 出现异常协议（如data:  
、ftp:  
）或伪协议  
## 3. 漏洞危害  
  
<table><thead><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><th style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border-width: 1px 1px 0px;border-top-style: solid;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-bottom-color: initial;border-left-color: rgb(223, 226, 229);border-image: initial;background: rgb(247, 247, 247);max-width: 100%;box-sizing: border-box;font-weight: bold;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">风险类型</span></span></th><th style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border-width: 1px 1px 0px;border-top-style: solid;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-bottom-color: initial;border-left-color: rgb(223, 226, 229);border-image: initial;background: rgb(247, 247, 247);max-width: 100%;box-sizing: border-box;font-weight: bold;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">具体危害</span></span></th><th style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border-width: 1px 1px 0px;border-top-style: solid;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-bottom-color: initial;border-left-color: rgb(223, 226, 229);border-image: initial;background: rgb(247, 247, 247);max-width: 100%;box-sizing: border-box;font-weight: bold;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">案例说明</span></span></th></tr></thead><tbody><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">钓鱼攻击</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">窃取凭证/财务信息</span></span></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">伪造银行登录页窃取账号密码</span></span></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">恶意软件分发</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">诱导下载木马/勒索软件</span></span></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">&#34;系统更新&#34;提示下载带毒程序</span></span></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">信任欺骗</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">利用可信域名背书</span></span></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">https://company.com -&gt; https://company-com.fake/login</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">绕过检测</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">规避安全防护机制</span></span></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">通过可信站点中转恶意链接</span></span></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">存储型XSS</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">配合脚本注入攻击</span></span></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">redirectUrl=data:text/html,alert(1)</span></code></td></tr></tbody></table>  
## 4. 黑盒渗透测试方法  
### 4.1 基础探测  
```
```  
### 4.2 测试Payload清单  
  
<table><thead><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><th style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border-width: 1px 1px 0px;border-top-style: solid;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-bottom-color: initial;border-left-color: rgb(223, 226, 229);border-image: initial;background: rgb(247, 247, 247);max-width: 100%;box-sizing: border-box;font-weight: bold;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">测试类型</span></span></th><th style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border-width: 1px 1px 0px;border-top-style: solid;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-bottom-color: initial;border-left-color: rgb(223, 226, 229);border-image: initial;background: rgb(247, 247, 247);max-width: 100%;box-sizing: border-box;font-weight: bold;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">测试Payload</span></span></th></tr></thead><tbody><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">外部域名</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">?url=https://attacker.com</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">特殊协议</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">?forward=ftp://evil.net</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">JS伪协议</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">?target=javascript:alert(document.domain)</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">编码绕过</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">?jump=https%3A%2F%2Fattacker.com</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">双重编码</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">?return=%252F%252Fevil.com</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">IP地址</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">?to=http://192.168.1.1</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">目录穿越</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">?next=/../../../../etc/passwd</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">空字节注入</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">?url=https://trusted.com\0.evil.com</span></code></td></tr></tbody></table>  
### 4.3 Burp Suite自动化  
```
```  
## 5. Java白盒审计指南  
### 5.1 审计流程  
  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/FUyHlHlguEiaCic0IynwTiaILJcaf1r1xEyepicwG9YKQoAN3DaAnGiaECKtm3R3s1AGXVvDGxeXtz8pgy1yNbqFESQ/640?wx_fmt=png&from=appmsg&watermark=1&tp=webp&wxfrom=5&wx_lazy=1 "")  
### 5.2 关键审计点  
1. **定位危险方法**  
：  
```
```  
  
1. **回溯数据流**  
：  
```
```  
  
1. **验证防护逻辑**  
：  
  
1. 白名单域名检查  
1. 协议限制（仅允许http/https）  
1. URL规范化处理  
1. 路径合法性验证  
## 6. Java中的关键代码  
### 6.1 危险重定向方法  
  
<table><thead><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><th style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border-width: 1px 1px 0px;border-top-style: solid;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-bottom-color: initial;border-left-color: rgb(223, 226, 229);border-image: initial;background: rgb(247, 247, 247);max-width: 100%;box-sizing: border-box;font-weight: bold;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">方法类型</span></span></th><th style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border-width: 1px 1px 0px;border-top-style: solid;border-right-style: solid;border-bottom-style: initial;border-left-style: solid;border-top-color: rgb(223, 226, 229);border-right-color: rgb(223, 226, 229);border-bottom-color: initial;border-left-color: rgb(223, 226, 229);border-image: initial;background: rgb(247, 247, 247);max-width: 100%;box-sizing: border-box;font-weight: bold;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">危险代码示例</span></span></th></tr></thead><tbody><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">Servlet API</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">response.sendRedirect(untrustedUrl);</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">Location Header</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">response.setHeader(&#34;Location&#34;, inputUrl);</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">Spring Redirect</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">return &#34;redirect:&#34; + request.getParam(&#34;url&#34;);</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);background-color: rgb(248, 248, 248);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">ModelAndView</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">new ModelAndView(&#34;redirect:&#34; + target);</span></code></td></tr><tr style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;break-inside: avoid;break-after: auto;border-top: 1px solid rgb(223, 226, 229);"><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><strong style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">RedirectView</span></span></strong></td><td style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 6px 13px;outline: 0px;overflow-wrap: break-word !important;word-break: break-all;hyphens: auto;border: 1px solid rgb(223, 226, 229);max-width: 100%;box-sizing: border-box;"><code style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px 2px;outline: 0px;max-width: 100%;box-sizing: border-box;overflow-wrap: break-word !important;font-family: &#34;Lucida Console&#34;, Consolas, Courier, monospace;text-align: left;vertical-align: initial;border: 1px solid rgb(231, 234, 237);background-color: rgb(243, 244, 244);border-radius: 3px;font-size: 0.9em;"><span leaf="" style="-webkit-tap-highlight-color: transparent;margin: 0px;padding: 0px;outline: 0px;max-width: 100%;box-sizing: border-box !important;overflow-wrap: break-word !important;">new RedirectView(userControlledUrl);</span></code></td></tr></tbody></table>  
### 6.2 安全重定向示例  
```
```  
## 7. PHP中的关键代码  
### 危险重定向函数：  
```
```  
### 安全重定向实现：  
```
```  
## 8. Java漏洞代码  
### 漏洞特征代码：  
```
```  
### 漏洞修复要点：  
1. **白名单校验**  
：建立可跳转域名/路径白名单  
1. **协议过滤**  
：仅允许http/https协议  
1. **URL规范化**  
：使用URI  
类解析标准化URL  
1. **域名验证**  
：验证目标域名是否在可信列表  
1. **相对路径处理**  
：禁止以../  
开头的相对路径  
## 9.实战  
#### redirect  
```
```  
  
没有任何限制，可以直接随意跳转  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/FUyHlHlguEiaCic0IynwTiaILJcaf1r1xEyGOel3gvdiaD7EYysUeP2eD5q5qGASdnuPuVIicn4KJibvo10wF8B0pyiag/640?wx_fmt=png&from=appmsg&watermark=1&tp=webp&wxfrom=5&wx_lazy=1 "")  
  
#### ModelAndView  
```
```  
  
  
没有任何限制，同样随意跳转  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/FUyHlHlguEiaCic0IynwTiaILJcaf1r1xEyR1I1lGAViaXo3fWDVef6ROK2hQ05lgYZont6nVwbTVw4JN59avsNEIA/640?wx_fmt=png&from=appmsg&watermark=1&tp=webp&wxfrom=5&wx_lazy=1 "")  
#### response.sendRedirect  
```
```  
## 没有任何限制，同样随意跳转  
  
![图片](https://mmbiz.qpic.cn/sz_mmbiz_png/FUyHlHlguEiaCic0IynwTiaILJcaf1r1xEyYNzfrpzhpV1aOSFWiamcS12ELsAc8UBYOw4VBxibOPtzEtrFhlrnyic1Q/640?wx_fmt=png&from=appmsg&watermark=1&tp=webp&wxfrom=5&wx_lazy=1 "")  
## 10.安全代码  
  
白名单模式  
```
```  
  
